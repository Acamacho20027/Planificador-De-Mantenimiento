<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bit치coras - Planificador de Mantenimiento</title>
    <link rel="stylesheet" href="../Styles/styles.css">
    <link rel="stylesheet" href="../Styles/custom-dashboard.css">
    <link rel="stylesheet" href="../Styles/design-tokens.css">
    <link rel="stylesheet" href="../Styles/visual-overrides.css">
    <link rel="stylesheet" href="../Styles/mobile-nav.css">
</head>
<body data-default-cliente="Cliente Principal">
    <header class="padding-global">
        <div class="container-large">
            <h1 class="heading-style-h1">Bit치coras</h1>
        </div>
    </header>

    <main class="padding-global padding-section-large">
        <div class="container-large dashboard-wrapper">
            <button id="nav-toggle" aria-label="Abrir men칰" style="background:transparent;border:none;cursor:pointer;" aria-expanded="false">
                <svg width="28" height="20" viewBox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <rect x="0" y="0" width="28" height="3" rx="1.5" fill="currentColor" />
                    <rect x="0" y="8.5" width="28" height="3" rx="1.5" fill="currentColor" />
                    <rect x="0" y="17" width="28" height="3" rx="1.5" fill="currentColor" />
                </svg>
            </button>
            <aside class="dashboard-nav">
                <h3 class="heading-style-h3">Men칰</h3>
                <nav>
                    <ul>
                        <li><a href="dashboard.html#home" class="dashboard-link">Home</a></li>
                        <li><a href="inspeccion.html" class="dashboard-link">Inspecci칩n</a></li>
                        <li><a href="dashboard.html#tasks" class="dashboard-link">Tareas</a></li>
                        <li><a href="dashboard.html#admin" class="dashboard-link">Administraci칩n</a></li>
                        <li><a href="bitacoras.html" class="dashboard-link active">Bit치coras</a></li>
                        <li class="nav-mobile-only">
                            <button type="button" id="menu-logout" class="dashboard-link logout-link">
                                <img src="/imagenes/icon-logout.svg" aria-hidden="true" style="height:16px;width:16px;filter:invert(1) grayscale(1) contrast(100%);">Cerrar sesi칩n
                            </button>
                        </li>
                    </ul>
                </nav>
            </aside>

            <section class="dashboard-content">
                <div class="dashboard-hero">
                    <div>
                        <p class="eyebrow">Microservicio FastAPI</p>
                        <h2 class="heading-style-h2">Procesa y descarga bit치coras</h2>
                        <div class="service-indicator" id="bitacora-service-status">Revisando servicio...</div>
                    </div>
                    <div class="hero-actions">
                        <button type="button" class="small outline" id="btn-check-service">Revisar estado</button>
                    </div>
                </div>

                <div class="bitacora-simple">
                    <div class="simple-card">
                        <div class="simple-head">
                            <div>
                                <p class="eyebrow">Flujo b치sico</p>
                                <h3>Generar bit치cora mensual</h3>
                                <p class="muted">El cliente ya est치 fijado. Solo elige el mes y presiona el bot칩n.</p>
                            </div>
                            <label class="toggle-advanced">
                                <input type="checkbox" id="toggle-avanzado" />
                                <span>Modo avanzado</span>
                            </label>
                        </div>
                        <div class="simple-grid">
                            <label class="form-field">
                                <span>Cliente</span>
                                <div class="pill pill-muted" id="cliente-fijo">Cliente Principal</div>
                            </label>
                            <label class="form-field">
                                <span>Bit치cora del mes</span>
                                <input type="month" id="input-periodo-simple" required />
                            </label>
                            <div class="simple-actions">
                                <button type="button" class="primary-big" id="btn-generar-simple">游녤 Generar bit치cora del mes</button>
                                <button type="button" class="primary-outline" id="btn-descargar-simple">Descargar Excel</button>
                            </div>
                        </div>
                        <div class="status-panel" id="simple-status" aria-live="polite">
                            <div class="status-title">Panel de estado</div>
                            <div class="status-body" id="simple-status-text">Selecciona mes y genera la bit치cora.</div>
                        </div>
                    </div>
                </div>

                <div id="zona-avanzada" class="bitacora-grid" hidden>
                    <article class="bitacora-panel wide" aria-labelledby="procesar-title">
                        <div class="panel-head">
                            <div>
                                <p class="eyebrow">Automatizaci칩n</p>
                                <h3 id="procesar-title">Procesar Bit치coras</h3>
                                <p class="muted">Lee .txt, procesa por cliente y periodo, y genera Excel.</p>
                            </div>
                        </div>
                        <div class="form-grid">
                            <label class="form-field">
                                <span>Cliente</span>
                                <select id="select-cliente-procesar"></select>
                            </label>
                            <label class="form-field">
                                <span>Periodo (YYYY-MM)</span>
                                <input type="month" id="input-periodo-procesar" />
                            </label>
                        </div>
                        <div class="form-grid">
                            <label class="form-field">
                                <span>Crear nuevo cliente</span>
                                <input type="text" id="nuevo-cliente" placeholder="Ej. Cliente Norte" />
                            </label>
                            <div class="form-field">
                                <span>&nbsp;</span>
                                <button type="button" class="small" id="btn-crear-cliente">Crear nuevo cliente</button>
                            </div>
                        </div>
                        <div class="actions-row">
                            <button type="button" class="small" id="btn-procesar">Procesar bit치coras</button>
                            <div class="pill pill-muted" id="procesar-info">Solo Administradores</div>
                        </div>
                        <div class="panel-log" id="procesar-status" aria-live="polite"></div>
                    </article>

                    <article class="bitacora-panel" aria-labelledby="metricas-title">
                        <div class="panel-head">
                            <p class="eyebrow">Visibilidad</p>
                            <h3 id="metricas-title">Ver M칠tricas</h3>
                            <p class="muted">Totales por cliente, estado y periodo.</p>
                        </div>
                        <div class="actions-row">
                            <button type="button" class="small ghost" id="btn-metricas">Consultar m칠tricas</button>
                        </div>
                        <div class="metrics-grid" id="metricas-resumen">
                            <div class="metric-box">
                                <p class="label">Registros</p>
                                <strong id="metricas-total">--</strong>
                            </div>
                            <div class="metric-box">
                                <p class="label">Clientes</p>
                                <strong id="metricas-clientes">--</strong>
                            </div>
                            <div class="metric-box">
                                <p class="label">Periodos</p>
                                <strong id="metricas-periodos">--</strong>
                            </div>
                        </div>
                        <div class="panel-log" id="metricas-detalle" aria-live="polite"></div>
                    </article>

                    <article class="bitacora-panel" aria-labelledby="descarga-title">
                        <div class="panel-head">
                            <p class="eyebrow">Exportaci칩n</p>
                            <h3 id="descarga-title">Descargar Excel</h3>
                            <p class="muted">Descarga directa desde FastAPI.</p>
                        </div>
                        <div class="form-grid">
                            <label class="form-field">
                                <span>Cliente</span>
                                <select id="select-cliente-descarga"></select>
                            </label>
                            <label class="form-field">
                                <span>Periodo (YYYY-MM)</span>
                                <input type="month" id="input-periodo-descarga" required />
                            </label>
                        </div>
                        <div class="actions-row">
                            <button type="button" class="small outline" id="btn-descargar">Descargar Excel</button>
                        </div>
                        <div class="panel-log" id="descarga-status" aria-live="polite"></div>
                    </article>

                    <div class="bitacora-log" id="bitacora-log" aria-live="polite"></div>
                </div>
            </section>
        </div>
    </main>

    <script src="../js/bitacoras.js"></script>
</body>
</html>
